<?xml version="1.0" ?>
<!DOCTYPE gprconfig [
  <!ENTITY filter_gnat '<compilers><compiler name="GNAT" /></compilers>'>
] >

<gprconfig>
  <!--  A base configuration for any version of GNAT
        That will need to be adjusted, and is provided mostly as
        an example. Note that the value of
        GNAT_Runtime_Dir and Toolchain_Version are currently incorrect -->

  <configuration>
   &filter_gnat;
   <config>
   package Naming is
      for Spec_Suffix ("Ada") use ".ads";
      for Body_Suffix ("Ada") use ".adb";
      for Casing use "lowercase";
      for Dot_Replacement use "-";
   end Naming;

   package Compiler is
      for Driver                   ("Ada") use "${PATH}${PREFIX}gcc";
      for Required_Switches        ("Ada") use ("-c", "-x", "ada", "-gnatA");
      for Mapping_File_Switches    ("Ada") use ("-gnatem=");
      for Mapping_Spec_Suffix      ("Ada") use "%s";
      for Mapping_Body_Suffix      ("Ada") use "%b";
      for Config_File_Switches     ("Ada") use ("-gnatec=");
      for Config_Body_File_Name    ("Ada") use
           "pragma Source_File_Name_Project (%u, Body_File_Name => ""%f"");";
      for Config_Spec_File_Name    ("Ada") use
           "pragma Source_File_Name_Project (%u, Spec_File_Name => ""%f"");";
      for Config_Body_File_Name_Pattern ("Ada") use
           "pragma Source_File_Name_Project " &amp;
           "  (Body_File_Name  => ""*%b""," &amp;
           "   Casing          => %c," &amp;
           "   Dot_Replacement => ""%d"");";
      for Config_Spec_File_Name_Pattern ("Ada") use
           "pragma Source_File_Name_Project " &amp;
           "  (Spec_File_Name  => ""*%s""," &amp;
           "   Casing          => %c," &amp;
           "   Dot_Replacement => ""%d"");";
      for Config_File_Unique    ("Ada") use "False";
      for Include_Path_File     ("Ada") use "ADA_PRJ_INCLUDE_FILE";
   end Compiler;

   package Binder is
      for Objects_Path_File     ("Ada") use "ADA_PRJ_OBJECTS_FILE";
      for Driver         ("Ada") use
          "${GPRCONFIG_PREFIX}/libexec/gprbuild/gprbind";
   end Binder;

   for Toolchain_Version     ("Ada") use "GNAT ${VERSION}";
   for Runtime_Library_Dir   ("Ada") use "${RUNTIME_DIR}";
   </config>
  </configuration>

  <!--  Whether -fPIC is needed -->
  <configuration>
   &filter_gnat;
   <targets negate="true">
      <target name=".*lynxos.*" />
      <target name=".*mingw.*" />
      <target name=".*dec-osf.*" />
      <target name=".*vms.*" />
   </targets>
   <config>
   package Compiler is
      for PIC_Option      ("Ada") use ("-fPIC");
   end Compiler;
   </config>
  </configuration>

  <!-- add the RTS= arg to the compiler and binder for GNAT -->
  <!-- ??? how do we generalize for any runtime? -->
  <configuration>
   <compilers>
     <compiler name="GNAT" runtime="sjlj" />
     <compiler name="GNAT" runtime="zfp" />
     <compiler name="GNAT" runtime="zcx" />
     <compiler name="GNAT" runtime="marte" />
     <compiler name="GNAT" runtime="cert" />
     <compiler name="GNAT" runtime="full" />
     <compiler name="GNAT" runtime="zfp" />
     <compiler name="GNAT" runtime="raven" />
     <compiler name="GNAT" runtime="soft-float" />
   </compilers>
   <config>
   package Compiler is
      for Required_Switches ("Ada") use
        Compiler'Required_Switches ("Ada") &amp; ("--RTS=$RUNTIME");
   end Compiler;

   package Binder is
      for Required_Switches ("Ada") use
        Binder'Required_Switches ("Ada") &amp; ("--RTS=$RUNTIME");
   end Binder;
   </config>
  </configuration>

  <!-- add commpiler option -msoft-float when the runtime is soft-float -->
  <configuration>
   <compilers>
     <compiler name="GNAT" runtime="soft-float" />
   </compilers>
   <config>
   package Compiler is
      for Required_Switches ("Ada") use
        Compiler'Required_Switches ("Ada") &amp; ("-msoft-float");
   end Compiler;
   </config>
  </configuration>
</gprconfig>
